[V6] Treinando v6_rc16k_v5b (batch=64, lr=1.5e-4, precision=float32)
2025-12-16 23:21:22.006563: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-16 23:21:22.037425: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-12-16 23:21:22.645555: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[INFO] Carregando dataset BrWaC...
[INFO] Split -> train: 3177727 | val: 353081
[INFO] 5000 documentos processados...
[INFO] 10000 documentos processados...
[INFO] 15000 documentos processados...
[INFO] 20000 documentos processados...
[INFO] 25000 documentos processados...
[INFO] 30000 documentos processados...
[INFO] 35000 documentos processados...
[INFO] 40000 documentos processados...
[INFO] 45000 documentos processados...
[INFO] 50000 documentos processados...
[INFO] 55000 documentos processados...
[INFO] 60000 documentos processados...
[INFO] 65000 documentos processados...
[INFO] 70000 documentos processados...
[INFO] 75000 documentos processados...
[INFO] 80000 documentos processados...
[INFO] 85000 documentos processados...
[INFO] 90000 documentos processados...
[INFO] 95000 documentos processados...
[INFO] 100000 documentos processados...
[INFO] 5000 documentos processados...
[INFO] 10000 documentos processados...
[INFO] Tokens treino: 58,762,451 | docs: 100000 | janelas: 612106
[INFO] Tokens validaÃ§Ã£o: 5,773,811 | docs: 10000 | janelas: 60141
[INFO] Tempo de encode: 86.27s
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1765927372.469976    9793 gpu_device.cc:2020] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22149 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:01:00.0, compute capability: 8.9
{
  "config": {
    "data": {
      "tokenizer_path": "versions/v6-release-candidate/tokenizers/unigram_16k/spm_v6.model",
      "seq_len": 256,
      "stride": 96,
      "batch_size": 64,
      "shuffle_buffer": 200000,
      "add_bos": true,
      "add_eos": true,
      "seed": 42,
      "drop_remainder": true
    },
    "corpus": {
      "max_docs": 100000,
      "min_len": 200,
      "valid_split": 0.1,
      "lowercase": true,
      "normalize_numbers": true,
      "drop_uppercase_metadata": true,
      "end_inline_sep": "newline"
    },
    "tokenizer_vocab": 14500
  },
  "train": {
    "docs": 100000,
    "tokens": 58762451,
    "windows": 612106,
    "batches": 9564,
    "avg_tokens_per_doc": 587.62451
  },
  "validation": {
    "docs": 10000,
    "tokens": 5773811,
    "windows": 60141,
    "batches": 939,
    "avg_tokens_per_doc": 577.3811
  },
  "encode_elapsed_sec": 86.27093482017517
}
[INFO] Politica de precisao ativa: float32.
[INFO] Treinando Transformer v5 -> epochs=24, steps/epoch=9564, tokens/epoch=156,696,576, warmup=4000, total_steps=229536
[INFO] Salvando checkpoints por Ã©poca em versions/v6-release-candidate/logs/checkpoints_v6_rc16k_v5b
Epoch 1/24
2025-12-16 23:23:11.544672: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:4: Filling up shuffle buffer (this may take a while): 92529 of 200000
2025-12-16 23:23:23.291240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.

[1m   1/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m84:13:23[0m 32s/step - accuracy: 1.8311e-04 - loss: 9.7167
[1m   2/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:27[0m 191ms/step - accuracy: 1.6785e-04 - loss: 9.7152 
[1m   3/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:06[0m 189ms/step - accuracy: 1.4581e-04 - loss: 9.7143
[1m   4/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m29:53[0m 188ms/step - accuracy: 1.3606e-04 - loss: 9.7141
[1m   5/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m29:56[0m 188ms/step - accuracy: 1.3082e-04 - loss: 9.7135
[1m   6/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:11[0m 189ms/step - accuracy: 1.2597e-04 - loss: 9.7130
[1m   7/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:16[0m 190ms/step - accuracy: 1.2043e-04 - loss: 9.7125
[1m   8/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:23[0m 191ms/step - accuracy: 1.1682e-04 - loss: 9.7123
[1m   9/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:30[0m 192ms/step - accuracy: 1.1364e-04 - loss: 9.7120
[1m  10/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:33[0m 192ms/step - accuracy: 1.1082e-04 - loss: 9.7118
[1m  11/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:22[0m 191ms/step - accuracy: 1.0881e-04 - loss: 9.7116
[1m  12/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:19[0m 191ms/step - accuracy: 1.0653e-04 - loss: 9.7115
[1m  13/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:24[0m 191ms/step - accuracy: 1.0447e-04 - loss: 9.7114
[1m  14/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:30[0m 192ms/step - accuracy: 1.0324e-04 - loss: 9.7112
[1m  15/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:33[0m 192ms/step - accuracy: 1.0205e-04 - loss: 9.7111
[1m  16/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:35[0m 192ms/step - accuracy: 1.0116e-04 - loss: 9.7110
[1m  17/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:37[0m 192ms/step - accuracy: 1.0007e-04 - loss: 9.7109
[1m  18/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:38[0m 193ms/step - accuracy: 9.9027e-05 - loss: 9.7107
[1m  19/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:40[0m 193ms/step - accuracy: 9.8211e-05 - loss: 9.7106
[1m  20/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:42[0m 193ms/step - accuracy: 9.7268e-05 - loss: 9.7104
[1m  21/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:39[0m 193ms/step - accuracy: 9.6511e-05 - loss: 9.7102
[1m  22/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:39[0m 193ms/step - accuracy: 9.5655e-05 - loss: 9.7100
[1m  23/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:39[0m 193ms/step - accuracy: 9.4842e-05 - loss: 9.7098
[1m  24/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:41[0m 193ms/step - accuracy: 9.4069e-05 - loss: 9.7096
[1m  25/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:42[0m 193ms/step - accuracy: 9.3334e-05 - loss: 9.7094
[1m  26/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:43[0m 193ms/step - accuracy: 9.2543e-05 - loss: 9.7092
[1m  27/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:44[0m 193ms/step - accuracy: 9.1711e-05 - loss: 9.7090
[1m  28/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:44[0m 193ms/step - accuracy: 9.0849e-05 - loss: 9.7088
[1m  29/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:44[0m 193ms/step - accuracy: 9.0039e-05 - loss: 9.7086
[1m  30/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:44[0m 193ms/step - accuracy: 8.9275e-05 - loss: 9.7083
[1m  31/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:42[0m 193ms/step - accuracy: 8.8619e-05 - loss: 9.7081
[1m  32/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:43[0m 193ms/step - accuracy: 8.7935e-05 - loss: 9.7079
[1m  33/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:44[0m 193ms/step - accuracy: 8.7400e-05 - loss: 9.7076
[1m  34/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:45[0m 194ms/step - accuracy: 8.6942e-05 - loss: 9.7073
[1m  35/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:46[0m 194ms/step - accuracy: 8.6501e-05 - loss: 9.7071
[1m  36/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:46[0m 194ms/step - accuracy: 8.6123e-05 - loss: 9.7068
[1m  37/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:47[0m 194ms/step - accuracy: 8.5712e-05 - loss: 9.7065
[1m  38/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:47[0m 194ms/step - accuracy: 8.5274e-05 - loss: 9.7062
[1m  39/9564[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m30:48[0m 194ms/step - accuracy: 8.4893e-05 - loss: 9.7060
