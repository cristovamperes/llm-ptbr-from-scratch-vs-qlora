[V6] Treinando v6_rc16k_v5b_aligned (batch=64, lr=1.5e-4, precision=float32)
2025-12-23 02:48:34.158369: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[INFO] Carregando dataset BrWaC...
[INFO] Split -> train: 3177727 | val: 353081
[INFO] 5000 documentos processados...
[INFO] 10000 documentos processados...
[INFO] 15000 documentos processados...
[INFO] 20000 documentos processados...
[INFO] 25000 documentos processados...
[INFO] 30000 documentos processados...
[INFO] 35000 documentos processados...
[INFO] 40000 documentos processados...
[INFO] 45000 documentos processados...
[INFO] 50000 documentos processados...
[INFO] 55000 documentos processados...
[INFO] 60000 documentos processados...
[INFO] 65000 documentos processados...
[INFO] 70000 documentos processados...
[INFO] 75000 documentos processados...
[INFO] 80000 documentos processados...
[INFO] 85000 documentos processados...
[INFO] 90000 documentos processados...
[INFO] 95000 documentos processados...
[INFO] 100000 documentos processados...
[INFO] 5000 documentos processados...
[INFO] 10000 documentos processados...
[INFO] Tokens treino: 56,767,172 | docs: 100000 | janelas: 591322
[INFO] Tokens validaÃ§Ã£o: 5,575,970 | docs: 10000 | janelas: 58080
[INFO] Tempo de encode: 179.60s
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1766458300.854089   13151 gpu_device.cc:2020] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22149 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:e1:00.0, compute capability: 8.9
{
  "config": {
    "data": {
      "tokenizer_path": "versions/v6-release-candidate/tokenizers/unigram_16k/spm_v6.model",
      "seq_len": 256,
      "stride": 96,
      "batch_size": 64,
      "shuffle_buffer": 200000,
      "add_bos": true,
      "add_eos": true,
      "seed": 42,
      "drop_remainder": true
    },
    "corpus": {
      "max_docs": 100000,
      "min_len": 200,
      "valid_split": 0.1,
      "lowercase": false,
      "normalize_numbers": false,
      "drop_uppercase_metadata": false,
      "end_inline_sep": "newline",
      "min_line_chars": 80,
      "min_alpha_ratio": 0.6
    },
    "tokenizer_vocab": 14500
  },
  "train": {
    "docs": 100000,
    "tokens": 56767172,
    "windows": 591322,
    "batches": 9239,
    "avg_tokens_per_doc": 567.67172
  },
  "validation": {
    "docs": 10000,
    "tokens": 5575970,
    "windows": 58080,
    "batches": 907,
    "avg_tokens_per_doc": 557.597
  },
  "encode_elapsed_sec": 179.59845447540283
}
[INFO] Politica de precisao ativa: float32.
[INFO] Treinando Transformer v5 -> epochs=24, steps/epoch=9239, tokens/epoch=151,371,776, warmup=4000, total_steps=221736
[INFO] Salvando checkpoints por Ã©poca em versions/v6-release-candidate/logs/checkpoints_v6_rc16k_v5b_aligned
Epoch 1/24
2025-12-23 02:52:10.288153: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:4: Filling up shuffle buffer (this may take a while): 32062 of 200000
2025-12-23 02:52:30.288038: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:4: Filling up shuffle buffer (this may take a while): 100117 of 200000
2025-12-23 02:52:40.288201: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:4: Filling up shuffle buffer (this may take a while): 135560 of 200000
2025-12-23 02:52:58.935715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.

[1m   1/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m204:38:06[0m 80s/step - accuracy: 0.0000e+00 - loss: 9.7062
[1m   2/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:31[0m 244ms/step - accuracy: 1.5259e-05 - loss: 9.7053  
[1m   3/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:02[0m 247ms/step - accuracy: 2.3736e-05 - loss: 9.7055
[1m   4/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:11[0m 248ms/step - accuracy: 2.9246e-05 - loss: 9.7057
[1m   5/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:12[0m 248ms/step - accuracy: 3.8045e-05 - loss: 9.7059
[1m   6/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:02[0m 247ms/step - accuracy: 4.3572e-05 - loss: 9.7058
[1m   7/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:10[0m 248ms/step - accuracy: 4.7313e-05 - loss: 9.7057
[1m   8/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:15[0m 249ms/step - accuracy: 5.1889e-05 - loss: 9.7056
[1m   9/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:22[0m 249ms/step - accuracy: 5.4412e-05 - loss: 9.7054
[1m  10/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:23[0m 250ms/step - accuracy: 5.8737e-05 - loss: 9.7053
[1m  11/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:13[0m 249ms/step - accuracy: 6.1468e-05 - loss: 9.7052
[1m  12/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:23[0m 250ms/step - accuracy: 6.3127e-05 - loss: 9.7051
[1m  13/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:23[0m 250ms/step - accuracy: 6.5133e-05 - loss: 9.7051
[1m  14/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:22[0m 250ms/step - accuracy: 6.7020e-05 - loss: 9.7051
[1m  15/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:12[0m 249ms/step - accuracy: 6.8520e-05 - loss: 9.7050
[1m  16/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:03[0m 248ms/step - accuracy: 6.9721e-05 - loss: 9.7050
[1m  17/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:59[0m 247ms/step - accuracy: 7.0689e-05 - loss: 9.7050
[1m  18/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:56[0m 247ms/step - accuracy: 7.1659e-05 - loss: 9.7049
[1m  19/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:56[0m 247ms/step - accuracy: 7.2453e-05 - loss: 9.7048
[1m  20/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:52[0m 246ms/step - accuracy: 7.3255e-05 - loss: 9.7047
[1m  21/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:52[0m 247ms/step - accuracy: 7.4057e-05 - loss: 9.7047
[1m  22/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:51[0m 246ms/step - accuracy: 7.4853e-05 - loss: 9.7046
[1m  23/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:52[0m 247ms/step - accuracy: 7.5521e-05 - loss: 9.7044
[1m  24/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:52[0m 247ms/step - accuracy: 7.5977e-05 - loss: 9.7043
[1m  25/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:55[0m 247ms/step - accuracy: 7.6258e-05 - loss: 9.7041
[1m  26/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:56[0m 247ms/step - accuracy: 7.6485e-05 - loss: 9.7040
[1m  27/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:56[0m 247ms/step - accuracy: 7.6667e-05 - loss: 9.7038
[1m  28/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:57[0m 247ms/step - accuracy: 7.6809e-05 - loss: 9.7036
[1m  29/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:58[0m 247ms/step - accuracy: 7.6991e-05 - loss: 9.7034
[1m  30/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:59[0m 247ms/step - accuracy: 7.7137e-05 - loss: 9.7032
[1m  31/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m37:59[0m 248ms/step - accuracy: 7.7189e-05 - loss: 9.7030
[1m  32/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:01[0m 248ms/step - accuracy: 7.7221e-05 - loss: 9.7028
[1m  33/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:02[0m 248ms/step - accuracy: 7.7235e-05 - loss: 9.7026
[1m  34/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:03[0m 248ms/step - accuracy: 7.7286e-05 - loss: 9.7024
[1m  35/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:03[0m 248ms/step - accuracy: 7.7320e-05 - loss: 9.7022
[1m  36/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:04[0m 248ms/step - accuracy: 7.7292e-05 - loss: 9.7019
[1m  37/9239[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m38:05[0m 248ms/step - accuracy: 7.7254e-05 - loss: 9.7017
